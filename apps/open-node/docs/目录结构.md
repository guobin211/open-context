# 一、顶层目录结构（小写文件名规范）

```
admin-rag/
├─ package.json
├─ tsconfig.json
├─ .env
├─ src/
│   ├─ api/
│   ├─ services/
│   ├─ jobs/
│   ├─ db/
│   ├─ indexers/
│   ├─ utils/
│   ├─ types/
│   └─ app.ts
├─ data/
│   ├─ leveldb/
│   └─ logs/
├─ tests/
├─ scripts/
└─ README.md
```

---

# 二、src 目录 + 文件名规范（kebab-case）

## 1️⃣ api/ — REST 路由

```
src/api/
├─ workspace-routes.ts
├─ repo-routes.ts
├─ index-routes.ts
├─ query-routes.ts
├─ graph-routes.ts
└─ router.ts
```

---

## 2️⃣ services/ — 核心业务逻辑

```
src/services/
├─ workspace-service.ts
├─ repo-service.ts
├─ indexer-service.ts
├─ vector-service.ts
├─ graph-service.ts
├─ job-service.ts
└─ rag-service.ts
```

---

## 3️⃣ jobs/ — 异步任务

```
src/jobs/
├─ index-job.ts
├─ reindex-job.ts
└─ job-queue.ts
```

---

## 4️⃣ db/ — 数据持久化

```
src/db/
├─ leveldb.ts
├─ qdrant-client.ts
├─ workspace-repository.ts
├─ repo-repository.ts
└─ job-repository.ts
```

---

## 5️⃣ indexers/ — 代码解析与索引

```
src/indexers/
├─ ast-parser.ts
├─ symbol-extractor.ts
├─ code-chunk-builder.ts
└─ graph-builder.ts
```

---

## 6️⃣ utils/ — 工具函数

```
src/utils/
├─ logger.ts
├─ git.ts
├─ vector.ts
├─ id.ts
└─ fs.ts
```

---

## 7️⃣ types/ — TypeScript 类型定义

```
src/types/
├─ workspace.ts
├─ repo.ts
├─ symbol.ts
├─ edge.ts
├─ qdrant.ts
└─ indexer.ts
```

---

## 8️⃣ app.ts — 启动入口

```
src/app.ts
```

职责：

- 初始化 Hono
- 初始化 Qdrant + LevelDB 图
- 加载内存 Graph
- 挂载 API 路由
- 启动 Job Queue

---

# 三、data/ — 持久化存储

```
data/
├─ leveldb/
│   ├─ edges/
│   └─ nodes/        # 可选
└─ logs/
```

---

# 四、tests/ — 测试目录

```
tests/
├─ api/
├─ services/
├─ indexers/
└─ graph/
```

> 测试文件名也建议用小写连字符：
>
> ```
> workspace-service.test.ts
> repo-service.test.ts
> graph-service.test.ts
> ```

---

# 五、scripts/ — 辅助脚本

```
scripts/
├─ init-workspace.ts
├─ seed-repos.ts
├─ migrate-leveldb.ts
└─ dump-qdrant.ts
```

---

# 六、命名规范总结

1. **所有文件名小写 + 连字符**（kebab-case）
   - 如 `graph-builder.ts`、`indexer-service.ts`

2. **目录小写**
   - `services/`、`indexers/`、`jobs/`

3. **测试文件**
   - 保持原文件名 + `.test.ts`

4. **脚本文件**
   - 小写 + 连字符，易在 CLI 调用

5. **模块导出保持 PascalCase / camelCase**（TypeScript 内部）
